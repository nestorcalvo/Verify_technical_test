
# Verify Technical test Nestor Calvo

Solution for the technical test done by Nestor Calvo CC. 1118871837.

## Documentation

For the creation of this project, multiple functions were created and stored in the utils.py file. A brief descriptions of this functions can be found here (all functions requires the OCR text):

- ***get_pages(text):*** Groups the two numbers that are after the word 'Page' and 'of'.
- ***get_invoice_info(text):*** Returns a dictionary with the information of 'Invoice Date', 'Due Date' and 'Invoice No.', to find this values a set of tabs are counted an the digits between those tabs are selected
- ***get_invoice_ammounts(text):*** Returns a dictionary with the quantities, rate, and ammounts found in the invoices, also, adds the type of invoce. For the ammounts, a set of spaces and numbers are searched and landmarks such as '|' and ':' are used to find the type of invoice.
- ***get_po_box_info(text):*** Uses a positive lookbehind to find elements that are afther the 'PO Box' phrase. Returns the po box name and the address
- ***get_account_info(text):*** Returns the month, the PO number and the account of the invoce
- ***get_info_name(text):*** Returns the name and address of the invoice owner
- ***get_value_currency(text):*** Returns the currency and the total value found at the end of the invoice
- ***get_bank_info(text):*** Returns the information related to the bank, like the account number, the bank name, the payment application used, the swift code, among others. 
- ***get_deparment_info(text):*** Returns basic information of the Accounts Receivable Department.

## Usage/Examples
Connect to API using the api_connection() function in the utils.py file
```python
client = api_connection()
```
Send each file to be process by the Veryfi API
```python
for file_path in files_path:
    file_name = os.path.splitext(os.path.basename(file_path))[0]
    file_name = file_name + '.json'
    response = client.process_document(file_path) 
```
Access the OCR text, generate the JSON file and store it
```python
    text_to_process = response['ocr_text']
    json_file = json_generation(text_to_process)
    store_json(json_file, os.path.join(JSON_PATH, file_name))
```


## Environment Variables

To run this project, you will need to add the following environment variables to your .env file

`CLIENT_ID`: ID of the client generated by Veryfi.

`CLIENT_SECRET`: Client secret generated by Veryfi.

`USERNAME_API`: Username generated by Veryfi.

`API_KEY`: API key generated by Veryfi.


## Authors

- [@nestorcalvo](https://www.github.com/nestorcalvo)


## Demo


Invoice PDF

![](https://github.com/nestorcalvo/Verify_technical_test/blob/main/images/Screenshot_2.png)

JSON generated

```json
{
  "invoice_info": {
    "Invoice Date": "09/11/23",
    "Due Date": "12/27/23",
    "Invoice No.": "16005913"
  },
  "pages": "1",
  "month": "August",
  "account": "D-99225830",
  "po_number": "PO-968G-0297",
  "invoice_ammounts": {
    "item_1": {
      "quantity": "6,016.09",
      "rate": "-1,781.87",
      "amount": "-10,719,890.29",
      "type": "Transport",
      "full_type": "Carrier Taxes for Transport"
    },
    "item_2": {
      "quantity": "3,372.59",
      "rate": "3,868.31",
      "amount": "13,046,223.62",
      "type": "Transport",
      "full_type": "Transport"
    },
    "item_3": {
      "quantity": "56789",
      "rate": "3,593.22",
      "amount": "4,915.32",
      "type": "Transport",
      "full_type": "Carrier Taxes for Transport"
    },
    "item_4": {
      "quantity": "1,714.46",
      "rate": "1,186.61",
      "amount": "2,034,395.38",
      "type": "Transport",
      "full_type": "Transport"
    },
    "item_5": {
      "quantity": "3,078.56",
      "rate": "5,076.42",
      "amount": "15,628,063.56",
      "type": "Transport",
      "full_type": "Transport"
    },
    "item_6": {
      "quantity": "6,480.38",
      "rate": "1,340.91",
      "amount": "8,689,606.35",
      "type": "Transport",
      "full_type": "Transport"
    }
  },
  "po_box": "674592",
  "po_box_address": "Dallas, TX 75267-4592\n",
  "user_name": "Nu Life Health",
  "user_address": "228 East 45th Street\nNew York, NY 10017\n",
  "value": "$46,340,224.75",
  "currency": "USD",
  "place_of_payment": "Switch, Ltd.",
  "bank_name": "PNC Bank, N.A.",
  "account_number": "3802512896",
  "ACH_routing": "083009060",
  "wire_routing": "043000096",
  "swift": "PNCCUS33",
  "deparment_phone": "702.522.2940",
  "deparment_fax": "702.444.9546",
  "deparment_email": "accountsreceivable@switch.com",
  "deparment_website": "www.switch.com"
}
```
